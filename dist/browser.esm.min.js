var t=(t,...e)=>{t&&console.log(..."string"==typeof e[0]?[`[tapsig] ${e[0]}`,...e.slice(1)]:e)};const e=Symbol("Proxy target"),n=Symbol("Promise marker"),o=Symbol("Catch all"),r=Symbol("Catch missing");function c(t){return!("object"!=typeof t&&"function"!=typeof t||null===t||t instanceof Promise)}function f(i,a,p,y){if(i instanceof u)return i.value;if(i instanceof Promise)return s(i)?i:(i[n]=!0,i.then(t=>f(t,a,p,y)));if(!c(i)||Reflect.has(i,e))return i;return t(y,"tap %o",i),new Proxy(i,{has:(t,n)=>n===e||Reflect.has(t,n),construct:(e,n)=>(t(y,"construct %o with %o",e,n),f(Reflect.construct(e,n),a,null,y)),get(n,c){if(c===e)return n;t(y,"get %o from %o",c,n);const u=("function"==typeof a?a(n):a)||Object.create(null);if("function"!=typeof i||null!==u&&"toString"in u||(u.toString=function(){return String(l(this))}),u instanceof Object?u.hasOwnProperty(c):c in u){t(y,"property %o shadowed by injected %o",c,u);const e=function(t,e,n){const o=Object.getOwnPropertyDescriptor(n,e);return o&&"function"==typeof o.get?Reflect.apply(o.get,t,[]):Reflect.get(n,e)}(n,c,u);return f(e,a,"function"==typeof e?n:null,y)}if(u instanceof Object&&Reflect.has(u,o)){return t(y,"property %o caught by ALL",c),f(Reflect.apply(Reflect.get(u,o),n,[c]),a,n,y)}if(Reflect.has(n,c))return f(Reflect.get(n,c),a,null,y);if(u instanceof Object&&Reflect.has(u,r)){return t(y,"property %o caught by MISSING",c),f(Reflect.apply(Reflect.get(u,r),n,[c]),a,n,y)}},apply:(e,n,o)=>(t(y,"call %o with %o as %o",e,o,n),f(Reflect.apply(e,n,o),a,null,y))})}function i(t,e=Object.create(null),n=!1){return f(t,e,null,n)}function l(t){return s(t)?t[e]:t}function u(t){this.value=t}function a(t){return new u(t)}function s(t){return c(t)&&e in t||t instanceof Promise&&n in t}export{o as ALL,r as MISSING,s as isTapped,a as mask,i as tap,l as untap};
