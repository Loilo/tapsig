var tapsig=function(t){"use strict";var e=(t,...e)=>{t&&console.log(..."string"==typeof e[0]?[`[tapsig] ${e[0]}`,...e.slice(1)]:e)};const n=Symbol("Proxy target"),o=Symbol("Promise marker"),r=Symbol("Catch all"),c=Symbol("Catch missing");function i(t){return!("object"!=typeof t&&"function"!=typeof t||null===t||t instanceof Promise)}function f(t,s,p,y){if(t instanceof u)return t.value;if(t instanceof Promise)return a(t)?t:(t[o]=!0,t.then(t=>f(t,s,p,y)));if(!i(t)||Reflect.has(t,n))return t;return e(y,"tap %o",t),new Proxy(t,{has:(t,e)=>e===n||Reflect.has(t,e),construct:(t,n)=>(e(y,"construct %o with %o",t,n),f(Reflect.construct(t,n),s,null,y)),get(o,i){if(i===n)return o;e(y,"get %o from %o",i,o);const u=("function"==typeof s?s(o):s)||Object.create(null);if("function"!=typeof t||null!==u&&"toString"in u||(u.toString=function(){return String(l(this))}),u instanceof Object?u.hasOwnProperty(i):i in u){e(y,"property %o shadowed by injected %o",i,u);const t=function(t,e,n){const o=Object.getOwnPropertyDescriptor(n,e);return o&&"function"==typeof o.get?Reflect.apply(o.get,t,[]):Reflect.get(n,e)}(o,i,u);return f(t,s,"function"==typeof t?o:null,y)}if(u instanceof Object&&Reflect.has(u,r)){return e(y,"property %o caught by ALL",i),f(Reflect.apply(Reflect.get(u,r),o,[i]),s,o,y)}if(Reflect.has(o,i))return f(Reflect.get(o,i),s,null,y);if(u instanceof Object&&Reflect.has(u,c)){return e(y,"property %o caught by MISSING",i),f(Reflect.apply(Reflect.get(u,c),o,[i]),s,o,y)}},apply:(t,n,o)=>(e(y,"call %o with %o as %o",t,o,n),f(Reflect.apply(t,n,o),s,null,y))})}function l(t){return a(t)?t[n]:t}function u(t){this.value=t}function a(t){return i(t)&&n in t||t instanceof Promise&&o in t}return t.ALL=r,t.MISSING=c,t.isTapped=a,t.mask=function(t){return new u(t)},t.tap=function(t,e=Object.create(null),n=!1){return f(t,e,null,n)},t.untap=l,t}({});
